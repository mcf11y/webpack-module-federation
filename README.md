# mf-template

## Описание

Репозиторий-шаблон для микрофронтэндов, основанный на [module federation](https://module-federation.io/)

Можно клонировать и на основе него писать микрофронтэнды.

Для этого достаточно доработать файл конфиг - `mf.config.js`

## Краткое изложение про Module Federation

MF - core webpack плагин (был добавлен в версию webpack 5) для создания одностраничных приложений (SPA) путем объединения отдельных сборок.

Эти сборки могут разрабатываться независимо друг от друга.
Позволяет точечно подключать модули из другой webpack-сборки, которая расположена на другом хосте.

Конфиги пишутся для webpack, но данная технология поддерживается и в vite, и во многих других сборщиках.

Все что может сбандлить Webpack (css, images, fonts, и тд) c MF может быть зашарено между микрофронтами.

MF может шарить между собой общие зависимости, если совпадает cемантическое версионирование.

MF могут быть развернуты на разных доменах и деплоиться независимо.
Сборка происходит на лету - при запуске приложения в браузере.

## Терминология

- Host (consumers) — это бандл, который первый инициализировался во время загрузки страницы. Это и есть наше корневое приложение, которое подтягивает другие части.
- Remote (consumable) — другой бандл, чьи некоторые части может импортировать host. Host запрашивает у remote шареные компоненты.
- Omnidirectional host — это бандл, который одновременно может быть и host, и remote. Он может быть и SPA-приложением, а может просто раздавать общие компоненты.
- Exposed modules.Модули, которые будут доступны другим приложением для импорта, например, компоненты, картинки или стили.
- Shared modules. Модули, которые могут быть общими для всего приложения, например, React.

## Пример взаимодействия модулей в MF

![диаграмм](https://media.licdn.com/dms/image/D4D12AQGtt8qKXdud7w/article-cover_image-shrink_720_1280/0/1677586047168?e=2147483647&v=beta&t=W2ylkxPfQi4mJdLbzrUorqvcl26NpCZMJ2k2CD-FOI0)

## Installation

- nvm use - установить нужную версию node
- yarn - устновить зависимости
- yarn build:dev - сбилдить dev версию проекта (по умолчанию в папку build)
- yarn build:prod - сбилдить prod версию проекта (по умолчанию в папку build)
- yarn start:dev - запустить dev версию проекту (по умолчанию на порту 3001)
- yarn start:prod - запустить prod версию проекту (по умолчанию на порту 3001)
- yarn stats:dev - запустить анализ dev сборки бандлов webpack
- yarn stats:prod - запустить анализ prod сборки бандлов webpack

## Usage

Для конфигурации микрофронта достаточно вносить правки в файл `mf.config.js`

- NAME - имя микрофронтэнда
- BUNDLE_NAME - имя (путь) module federation бандла на экспорт
- LOCAL_DEV_PORT - порт для локального запуска
- PROD_URL - ...
- ! exposes - модули /компоненты которые экспортируем из проекта
- ! remotes - другой микрофронт (импортируемый в проект)
- ! shared - общие библиотеки, которые шарим между другими микрофронтами - для уменьшения бандла
